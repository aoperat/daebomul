<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>쿠폰 코드 링크 생성기</title>
    <!-- ================================
         [Google Tag Manager 코드 시작]
         사이트 방문자 트래픽, 마케팅 태그 관리
         ================================ -->
    <script>
        // Google Tag Manager 삽입 스크립트 (head 영역)
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({
                'gtm.start': new Date().getTime(),
                event: 'gtm.js'
            });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-W4RB5JWP');
    </script>
    <!-- ================================
         [Google Tag Manager 코드 끝]
         ================================ -->

    <!-- ================================
         [Google Analytics 4 코드 시작]
         방문자/이벤트 데이터 수집
         ================================ -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XF9H5LNT7T"></script>
    <script>
        // GA4(구글 애널리틱스) 기본 설정
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-XF9H5LNT7T');
    </script>
    <!-- ================================
         [Google Analytics 4 코드 끝]
         ================================ -->

    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            padding: 20px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 6px 8px;
            text-align: center;
        }

        th {
            background: #f5f5f5;
        }

        tr:nth-child(even) {
            background: #fafafa;
        }

        input[type="text"] {
            font-size: 16px;
            padding: 5px;
        }

        button {
            padding: 4px 10px;
            cursor: pointer;
        }

        .donate-btn {
            margin-bottom: 18px;
            background: #ffe07a;
            border: 1px solid #ddbc36;
            color: #694400;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <!-- ================================
         [Google Tag Manager noscript 버전]
         JS 비활성화 사용자 트래픽도 수집
         ================================ -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W4RB5JWP"
                height="0" width="0"
                style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- ================================ -->

    <button class="donate-btn" onclick="showDonate()">💝 후원하기</button>
    <h2>쿠폰 코드 링크 생성기</h2>
    <label>
        UID 입력:
        <input type="text" id="uid" placeholder="UID 입력">
    </label>
    <button id="openSelectedBtn">체크된 링크 일괄 열기</button>
    <table>
        <thead>
            <tr>
                <th>
                    <input type="checkbox" id="selectAll"> 전체
                </th>
                <th>번호</th>
                <th>코드</th>
                <th>보상/설명</th>
                <th>링크 이동</th>
            </tr>
        </thead>
        <tbody id="coupon-tbody">
            <!-- 데이터가 JS로 생성됩니다 -->
        </tbody>
    </table>
    <script>
        // 후원 팝업
        function showDonate() {
            alert(
                `[후원 안내]

예금주: 이*환
국민은행: 102702-04-128855

작은 후원도 큰 힘이 됩니다. 감사합니다!`
            );
        }

        // 쿠폰 데이터
        const coupons = [
            { code: "RINKARMA", desc: "린 *" },
            { code: "SECRETCODE", desc: "루비 300개, 열쇠 30개" },
            { code: "777SENARE", desc: "루비 300개, 열쇠 30개" },
            { code: "JJOLJACK", desc: "루비 300개, 열쇠 30개" },
            { code: "LOVESENA", desc: "루비 300개, 열쇠 30개" },
            { code: "SENAREGOGO", desc: "골드 30만개" },
            { code: "", desc: "" },
            { code: "GOODLUCK", desc: "골드 30만개" },
            { code: "SEVENVSDARK", desc: "골드 30만개" },
            { code: "7777777", desc: "골드 30만개" },
            { code: "", desc: "" },
            { code: "SURPRISE", desc: "골드 30만개" },
            { code: "THEMONTHOFSENA", desc: "골드 30만개" },
            { code: "", desc: "" },
            { code: "7SENASENA7", desc: "이벤트 펫 [희귀] 두 *" },
            { code: "INTOTHESENA", desc: "열쇠 상자 5개" },
            { code: "", desc: "" },
            { code: "REBIRTHBACK", desc: "열쇠 상자 5개" },
            { code: "WELCOMEBACK", desc: "열쇠 상자 5개" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "LODING", desc: "열쇠 상자 3개, 골드 10만개" },
            { code: "GUILDWAR", desc: "이벤트 펫 [희귀] 미믹 *" },
            { code: "HEROSOMMON", desc: "열쇠 240개, 골드 15만개" },
            { code: "", desc: "" },
            { code: "INFOCODEX", desc: "열쇠 120개, 골드 15만개" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "BONVOYAGE", desc: "픽업 소환 이용권 5개" },
            { code: "", desc: "" },
            { code: "INFINITETOWER", desc: "영웅 소환 이용권 5개" },
            { code: "STORYEVENT", desc: "영웅 소환 이용권 5개" },
            { code: "EVANKARIN", desc: "영웅 소환 이용권 5개" },
            { code: "SENARAID", desc: "영웅 소환 이용권 5개" },
            { code: "WELCOMESENA", desc: "펫 소환 이용권 5개" },
            { code: "MOONLIGHTCOAST", desc: "펫 소환 이용권 5개" },
            { code: "MOREKEYS", desc: "푸키의 증표 2개, 열쇠 상자 1개" },
            { code: "SHOWMETHEMONEY", desc: "푸키의 증표 2개, 열쇠 상자 1개" },
            { code: "", desc: "" },
            { code: "MAILBOX", desc: "진화 재료 상자 (중) 50개" },
            { code: "", desc: "" },
            { code: "RELEASEPET", desc: "진화재료 선택 상자 (상) 30개" },
            { code: "", desc: "" },
            { code: "NOHOSCHRONICLE", desc: "일반 영웅 소환권 10개" },
            { code: "UPDATES", desc: "일반 영웅 소환권 10개" },
            { code: "THANKYOU", desc: "일반 영웅 소환권 10개" },
            { code: "SENAHAJASENA", desc: "일반 영웅 소환권 10개" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "FORTAGNIA", desc: "고급 영웅 소환권 10개" },
            { code: "YUISSONG", desc: "고급 영웅 소환권 10개" },
            { code: "YONGSANIM", desc: "고급 영웅 소환권 10개" },
            { code: "PUKIDANCE", desc: "고급 영웅 소환권 10개" },
            { code: "ADVENTURER", desc: "고급 영웅 소환권 10개" },
            { code: "", desc: "" },
            { code: "", desc: "" },
            { code: "LEGENDSRAID", desc: "희귀 영웅 소환권 1개, 골드 10만개" },
            { code: "SHININGPRISM", desc: "희귀 영웅 소환권 1개, 골드 10만 개" },
            { code: "", desc: "" },
            { code: "HTRIBERANES", desc: "희귀 영웅 소환권 1개, 골드 10만개" },
            { code: "SADENDING", desc: "희귀~전설 영웅 소환권 1개" },
            { code: "TREASURE", desc: "6성 희귀 영웅 소환권 1개" },
            { code: "THEHOLYCROSS", desc: "6성 희귀 영웅 소환권 1개" },
            { code: "VALKYRIE", desc: "스킬 강화석 1개" },
            { code: "LOVELYRUBY", desc: "스킬 강화석 1개" },
            { code: "", desc: "" },
            { code: "SENAEVENTS", desc: "스킬 강화석 1개" },
            { code: "CMMAY", desc: "알 2개 2개 3개" },
            { code: "PDKIMJUNGKI", desc: "알 2개 2개 3개" },
            { code: "FUSEGETSPECIAL", desc: "알 2개 2개 3개" },
            { code: "DARKKNIGHTS", desc: "알 2개 2개 3개" },
            { code: "JULYSENAMONTH", desc: "알 2개 2개 3개" }
        ];

        // 테이블 생성
        const tbody = document.getElementById('coupon-tbody');
        coupons.forEach((row, i) => {
            const tr = document.createElement('tr');

            // 체크박스
            const tdCheck = document.createElement('td');
            if (row.code) {
                const cb = document.createElement('input');
                cb.type = 'checkbox';
                cb.className = 'cb-coupon';
                cb.dataset.idx = i;
                tdCheck.appendChild(cb);
            }
            tr.appendChild(tdCheck);

            // 번호
            const tdNum = document.createElement('td');
            tdNum.textContent = i + 1;
            tr.appendChild(tdNum);

            // 코드
            const tdCode = document.createElement('td');
            tdCode.textContent = row.code;
            tr.appendChild(tdCode);

            // 설명
            const tdDesc = document.createElement('td');
            tdDesc.textContent = row.desc;
            tr.appendChild(tdDesc);

            // 버튼
            const tdBtn = document.createElement('td');
            if (row.code) {
                const btn = document.createElement('button');
                btn.textContent = "이동";
                btn.onclick = function () {
                    const uid = document.getElementById('uid').value.trim();
                    if (!uid) {
                        alert('UID를 입력하세요.');
                        document.getElementById('uid').focus();
                        return;
                    }
                    const url = `https://coupon.netmarble.com/tskgb?playerId=${encodeURIComponent(uid)}&code=${row.code}`;
                    window.open(url, '_blank');
                };
                tdBtn.appendChild(btn);
            }
            tr.appendChild(tdBtn);

            tbody.appendChild(tr);
        });

        // 전체선택 기능
        document.getElementById('selectAll').addEventListener('change', function () {
            const checked = this.checked;
            document.querySelectorAll('.cb-coupon').forEach(cb => {
                cb.checked = checked;
            });
        });

        // 개별 체크 해제/선택시 전체선택 상태 동기화
        tbody.addEventListener('change', function (e) {
            if (e.target.classList.contains('cb-coupon')) {
                const allCheckboxes = Array.from(document.querySelectorAll('.cb-coupon'));
                const allChecked = allCheckboxes.every(cb => cb.checked);
                document.getElementById('selectAll').checked = allChecked;
            }
        });

        // 일괄 오픈 버튼 기능
        document.getElementById('openSelectedBtn').onclick = function () {
            const uid = document.getElementById('uid').value.trim();
            if (!uid) {
                alert('UID를 입력하세요.');
                document.getElementById('uid').focus();
                return;
            }
            const checked = document.querySelectorAll('.cb-coupon:checked');
            if (checked.length === 0) {
                alert('적어도 하나 이상 선택하세요.');
                return;
            }
            checked.forEach(cb => {
                const idx = Number(cb.dataset.idx);
                const code = coupons[idx].code;
                const url = `https://coupon.netmarble.com/tskgb?playerId=${encodeURIComponent(uid)}&code=${code}`;
                window.open(url, '_blank');
            });
        };
    </script>
</body>

</html>
