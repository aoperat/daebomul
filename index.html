<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>대보물시대 쿠폰 코드 링크 생성기</title>



    <!-- ================================
         [Google Tag Manager 코드 시작]
         사이트 방문자 트래픽, 마케팅 태그 관리
         ================================ -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || [];
            w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
            var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
            j.async = true;
            j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
            f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-W4RB5JWP');
    </script>
    <!-- ================================
         [Google Tag Manager 코드 끝]
         ================================ -->




    <!-- ================================
         [Google Analytics 4 코드 시작]
         방문자/이벤트 데이터 수집
         ================================ -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XF9H5LNT7T"></script>
    <script>
        // GA4(구글 애널리틱스) 기본 설정
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-XF9H5LNT7T');
    </script>
    <!-- ================================
         [Google Analytics 4 코드 끝]
         ================================ -->


    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 부트스트랩 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <meta name="keywords"
        content="세븐나이츠, 대보물시대, 쿠폰, 자동입력, 세나쿠폰, Netmarble, 쿠폰 코드, 자동 쿠폰 등록, 세나, Daebomul, coupon, SevenKnights">
    <meta name="description"
        content="세븐나이츠, 대보물시대 등 다양한 게임 쿠폰을 빠르고 편하게 자동입력할 수 있는 쿠폰 링크 생성기! UID 입력만으로 대량 쿠폰 자동 오픈. 개발자 제공, 무료 사용.">

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <style>
       
    </style>
</head>

<body class="d-flex flex-column min-vh-100">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W4RB5JWP" height="0" width="0"
            style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- 모바일용 커피사기 플로팅 버튼 -->
    <button id="fab-coffee" type="button" data-bs-toggle="modal" data-bs-target="#donateModal">
        <i class="bi bi-cup-hot"></i> 커피사기
    </button>

    <!-- 후원 모달 -->
    <div class="modal fade" id="donateModal" tabindex="-1" aria-labelledby="donateModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="donateModalLabel">후원 계좌 안내</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
                </div>
                <div class="modal-body text-center">
                    <div class="mb-2 fw-bold">예금주: <span class="text-primary">이*환</span></div>
                    <div class="mb-2">국민은행: <span class="fw-bold">102702-04-128855</span></div>
                    <div class="mt-2 text-muted small">작은 후원도 큰 힘이 됩니다.<br>감사합니다!</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Header & Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand fw-bold" href="#">세나쿠폰</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain"
                aria-controls="navbarMain" aria-expanded="false" aria-label="메뉴 열기">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarMain">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">대보물시대 쿠폰</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="coupon-seven.html">세븐나이츠 쿠폰</a>
                    </li>
                </ul>
                <!-- PC용 커피사기 버튼(모바일에서는 숨김) -->
                <a href="#" class="btn btn-warning fw-bold ms-lg-2" data-bs-toggle="modal"
                    data-bs-target="#donateModal">☕ 개발자에게 커피사기</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-shrink-0" style="padding-top:72px">
        <div class="container py-4">
            <h2 class="mb-4 fw-bold text-primary">대보물시대 쿠폰 코드 링크 생성기</h2>
            <div class="small text-muted mb-1 ms-1">[광고] 광고 클릭 시 새 창에서 이동합니다</div>
            <!-- 광고 배너 예시 캐러셀 -->
            <div id="adCarousel" class="carousel slide mb-3" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#adCarousel" data-bs-slide-to="0" class="active"
                        aria-current="true" aria-label="1"></button>
                    <button type="button" data-bs-target="#adCarousel" data-bs-slide-to="1" aria-label="2"></button>
                </div>
                <div class="carousel-inner rounded shadow-sm">
                    <div class="carousel-item" data-bs-interval="6000">
                        <a href="https://link.coupang.com/a/cFrc3H" target="_blank" rel="noopener"
                            onclick="trackAdClick('세나 칠성사이다', 'https://link.coupang.com/a/cFrc3H')">
                            <img src="ad/사이다.png" class="d-block w-100" alt="세나 칠성사이다">
                        </a>
                    </div>
                    <div class="carousel-item active" data-bs-interval="6000">
                        <a href="https://link.coupang.com/a/cFrddm" target="_blank" rel="noopener"
                            onclick="trackAdClick('마비노기 피규어', 'https://link.coupang.com/a/cFrddm')">
                            <img src="ad/마비노기.png" class="d-block w-100" alt="마비노기 피규어">
                        </a>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#adCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                    <span class="visually-hidden">이전</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#adCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                    <span class="visually-hidden">다음</span>
                </button>
            </div>
            <div class="alert alert-warning py-2 mb-2">
                광고를 클릭하셔야 <b>'체크된 링크 일괄 열기'</b> 버튼이 활성화됩니다.
            </div>
            <p style="color: #b71c1c; font-weight: bold;">
                ※ iOS(Safari 등)에서는 보안 정책상 한 번에 하나의 탭만 열립니다.<br>
                여러 사이트를 한 번에 열려면 PC 브라우저를 이용해 주세요.
            </p>
            <div class="mb-3">
                <label for="uid" class="form-label">UID 입력</label>
                <input type="text" id="uid" class="form-control w-auto d-inline-block" placeholder="UID 입력">
                <button id="openSelectedBtn" class="btn btn-success ms-2" disabled>
                    체크된 링크 일괄 열기 (광고 클릭 시 활성화)
                </button>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered align-middle mb-4">
                    <thead class="table-light">
                        <tr>
                            <th><input type="checkbox" id="selectAll"> 전체</th>
                            <th>번호</th>
                            <th>코드</th>
                            <th>보상/설명</th>
                            <th>링크 이동</th>
                        </tr>
                    </thead>
                    <tbody id="coupon-tbody">
                        <!-- 데이터가 JS로 생성됩니다 -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>
    <!-- Footer -->
    <footer class="footer mt-auto py-3 border-top">
        <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center gap-2">
            <div class="d-flex align-items-center gap-2">
                <a href="https://aoperat.github.io" class="btn btn-outline-primary" target="_blank" rel="noopener">
                    개발자 블로그
                </a>
                <a href="https://developro.tistory.com/" class="btn btn-outline-success" target="_blank" rel="noopener">
                    개발자 티스토리
                </a>
            </div>
            <div class="text-muted small">&copy; 2025 디벨로프로. All rights reserved.</div>
        </div>
    </footer>
    <!-- scripts -->
    <script src="coupons-dae.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // UID 저장/불러오기
        window.addEventListener('DOMContentLoaded', function () {
            const saved = localStorage.getItem('coupontool_uid');
            if (saved) document.getElementById('uid').value = saved;
        });
        document.getElementById('uid').addEventListener('input', function (e) {
            localStorage.setItem('coupontool_uid', e.target.value);
        });

        // 광고 클릭 여부
        let isAdClicked = false;

        // 쿠폰 테이블 렌더링 함수
        function renderTable() {
            const tbody = document.getElementById('coupon-tbody');
            tbody.innerHTML = '';
            coupons.forEach((row, i) => {
                const tr = document.createElement('tr');

                // 체크박스
                const tdCheck = document.createElement('td');
                if (row.code) {
                    const cb = document.createElement('input');
                    cb.type = 'checkbox';
                    cb.className = 'cb-coupon';
                    cb.dataset.idx = i;
                    if (i >= 10 && !isAdClicked) cb.disabled = true;
                    tdCheck.appendChild(cb);
                }
                tr.appendChild(tdCheck);

                // 번호
                const tdNum = document.createElement('td');
                tdNum.textContent = i + 1;
                tr.appendChild(tdNum);

                // 코드
                const tdCode = document.createElement('td');
                tdCode.textContent = row.code;
                tr.appendChild(tdCode);

                // 설명
                const tdDesc = document.createElement('td');
                tdDesc.textContent = row.desc;
                tr.appendChild(tdDesc);

                // 이동 버튼
                const tdBtn = document.createElement('td');
                if (row.code) {
                    const btn = document.createElement('button');
                    btn.textContent = "이동";
                    btn.className = "btn btn-outline-primary btn-sm";
                    if (i >= 10 && !isAdClicked) {
                        btn.disabled = true;
                        btn.classList.add('disabled');
                        btn.onclick = function () {
                            alert("10번째 이후 쿠폰은 광고 클릭 후에 활성화됩니다.\n광고를 클릭해주세요.");
                            document.getElementById('selectAll').checked = false;
                            document.querySelectorAll('.cb-coupon').forEach(cb => cb.checked = false);
                        }
                    } else {
                        btn.onclick = function () {
                            const uid = document.getElementById('uid').value.trim();
                            if (!uid) {
                                alert('UID를 입력하세요.');
                                document.getElementById('uid').focus();
                                return;
                            }
                            const url = `https://coupon.netmarble.com/tskgb?playerId=${encodeURIComponent(uid)}&code=${row.code}`;
                            window.open(url, '_blank');
                        };
                    }
                    tdBtn.appendChild(btn);
                }
                tr.appendChild(tdBtn);
                tbody.appendChild(tr);

                // 안내 tr은 10번째 쿠폰 다음(i === 9)에서 한번만 추가
                if (i === 9 && !isAdClicked) {
                    const noticeTr = document.createElement('tr');
                    const noticeTd = document.createElement('td');
                    noticeTd.colSpan = 5;
                    noticeTd.className = "text-center";
                    noticeTd.style.color = "#b71c1c";
                    noticeTd.style.fontWeight = "bold";
                    noticeTd.style.background = "#fffde7";
                    noticeTd.textContent = "※ 10번째 이후 쿠폰은 광고 클릭 후 활성화됩니다. 광고를 클릭하시면 모든 쿠폰을 사용할 수 있습니다.";
                    noticeTr.appendChild(noticeTd);
                    tbody.appendChild(noticeTr);
                }
            });
        }

        renderTable();

        // 전체선택 기능
        document.getElementById('selectAll').addEventListener('change', function () {
            const checked = this.checked;
            document.querySelectorAll('.cb-coupon').forEach(cb => {
                if (!cb.disabled) cb.checked = checked;
            });
        });

        // 개별 체크시 전체선택 상태 동기화
        document.getElementById('coupon-tbody').addEventListener('change', function (e) {
            if (e.target.classList.contains('cb-coupon')) {
                const allCheckboxes = Array.from(document.querySelectorAll('.cb-coupon')).filter(cb => !cb.disabled);
                const allChecked = allCheckboxes.length > 0 && allCheckboxes.every(cb => cb.checked);
                document.getElementById('selectAll').checked = allChecked;
            }
        });

        // 일괄 오픈 버튼
        document.getElementById('openSelectedBtn').onclick = function () {
            const uid = document.getElementById('uid').value.trim();
            if (!uid) {
                alert('UID를 입력하세요.');
                document.getElementById('uid').focus();
                return;
            }
            const checked = document.querySelectorAll('.cb-coupon:checked');
            if (checked.length === 0) {
                alert('적어도 하나 이상 선택하세요.');
                return;
            }
            checked.forEach(cb => {
                const idx = Number(cb.dataset.idx);
                const code = coupons[idx].code;
                const url = `https://coupon.netmarble.com/tskgb?playerId=${encodeURIComponent(uid)}&code=${code}`;
                window.open(url, '_blank');
            });
        };

        // 광고 클릭 시 실행 함수 (a태그 onclick에서 호출)
        function trackAdClick(label, url) {
            if (typeof gtag === 'function') {
                gtag('event', 'ad_click', {
                    event_category: 'Ad',
                    event_label: label,
                    ad_url: url
                });
            }
            isAdClicked = true;
            document.getElementById('openSelectedBtn').disabled = false;
            document.getElementById('openSelectedBtn').textContent = '체크된 링크 일괄 열기';
            renderTable(); // 비활성화 해제
        }
        window.trackAdClick = trackAdClick;
    </script>
</body>

</html>